(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6dd6c1c4"],{"20fd":function(e,t,s){"use strict";var l=s("d9f6"),r=s("aebd");e.exports=function(e,t,s){t in e?l.f(e,t,r(0,s)):e[t]=s}},"396a":function(e,t,s){},"549b":function(e,t,s){"use strict";var l=s("d864"),r=s("63b6"),i=s("241e"),a=s("b0dc"),n=s("3702"),o=s("b447"),c=s("20fd"),u=s("7cd6");r(r.S+r.F*!s("4ee1")(function(e){Array.from(e)}),"Array",{from:function(e){var t,s,r,d,f=i(e),m="function"==typeof this?this:Array,p=arguments.length,b=p>1?arguments[1]:void 0,h=void 0!==b,g=0,v=u(f);if(h&&(b=l(b,p>2?arguments[2]:void 0,2)),void 0==v||m==Array&&n(v))for(t=o(f.length),s=new m(t);t>g;g++)c(s,g,h?b(f[g],g):f[g]);else for(d=v.call(f),s=new m;!(r=d.next()).done;g++)c(s,g,h?a(d,b,[r.value,g],!0):r.value);return s.length=g,s}})},"54a1":function(e,t,s){s("6c1c"),s("1654"),e.exports=s("95d5")},"62ef":function(e,t,s){"use strict";var l=s("396a"),r=s.n(l);r.a},"75fc":function(e,t,s){"use strict";var l=s("a745"),r=s.n(l);function i(e){if(r()(e)){for(var t=0,s=new Array(e.length);t<e.length;t++)s[t]=e[t];return s}}var a=s("774e"),n=s.n(a),o=s("c8bb"),c=s.n(o);function u(e){if(c()(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e))return n()(e)}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function f(e){return i(e)||u(e)||d()}s.d(t,"a",function(){return f})},"774e":function(e,t,s){e.exports=s("d2d5")},"8fa2":function(e,t,s){"use strict";s.r(t);var l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page flex-v"},[s("div",{staticClass:"head flex-v-center flex-justify"},[s("el-breadcrumb",{staticClass:"my-breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[s("el-breadcrumb-item",{attrs:{to:{name:"SetMealList"}}},[e._v("套餐维护")]),s("el-breadcrumb-item",[e._v(e._s("insert"===e.id?"新增":"修改"))])],1)],1),s("div",{staticClass:"container flex-item"},[s("el-form",{ref:"form",staticClass:"default-form-style",attrs:{size:"small","label-width":"auto",model:e.formFields,rules:e.rules}},[s("el-row",[s("el-col",{attrs:{span:6}},[s("el-form-item",{attrs:{label:"套餐名称：",prop:"packName"}},[s("el-input",{attrs:{maxlength:"51",placeholder:"请输入"},model:{value:e.formFields.packName,callback:function(t){e.$set(e.formFields,"packName",t)},expression:"formFields.packName"}})],1)],1),s("el-col",{attrs:{span:6}},[s("el-form-item",{attrs:{label:"套餐顺序：",prop:"sortNum"}},[s("el-input",{attrs:{value:e.formFields.sortNum,maxlength:"5",placeholder:"请输入"},on:{input:function(t){return e.$outInt(t,"sortNum",e.formFields)}}})],1)],1),s("el-col",{attrs:{span:6}},[s("el-form-item",{attrs:{label:"拼音简码：",prop:"pySimpleCode"}},[s("el-input",{attrs:{maxlength:"51",placeholder:"请输入"},model:{value:e.formFields.pySimpleCode,callback:function(t){e.$set(e.formFields,"pySimpleCode",t)},expression:"formFields.pySimpleCode"}})],1)],1),s("el-col",{attrs:{span:6}},[s("el-form-item",{attrs:{label:"五笔简码：",prop:"wbSimpleCode"}},[s("el-input",{attrs:{maxlength:"51",placeholder:"请输入"},model:{value:e.formFields.wbSimpleCode,callback:function(t){e.$set(e.formFields,"wbSimpleCode",t)},expression:"formFields.wbSimpleCode"}})],1)],1),s("el-col",{attrs:{span:6}},[s("el-form-item",{attrs:{label:"是否启用："}},[s("el-select",{model:{value:e.formFields.enabled,callback:function(t){e.$set(e.formFields,"enabled",t)},expression:"formFields.enabled"}},[s("el-option",{attrs:{value:"1",label:"启用"}}),s("el-option",{attrs:{value:"2",label:"禁用"}})],1)],1)],1),s("el-col",[s("div",{staticClass:"flex",staticStyle:{"padding-top":"20px"}},[s("div",{staticClass:"left-box"},[s("h4",[e._v("选择项目")]),s("div",{staticClass:"item-box "},[s("el-collapse",[e._l(e.projectList,function(t){return[t.smallProjects.length?s("el-collapse-item",{key:t.sysGuid},[s("div",{staticClass:"collapse-head",attrs:{slot:"title"},on:{click:function(e){e.stopPropagation()}},slot:"title"},[s("el-checkbox",{attrs:{label:t.sysGuid,indeterminate:!(!t.ids.length||t.isAllSelect)},on:{change:function(s){return e.handleAllSelect(s,t)}},model:{value:t.isAllSelect,callback:function(s){e.$set(t,"isAllSelect",s)},expression:"item.isAllSelect"}},[e._v(e._s(t.pname))])],1),s("el-checkbox-group",{on:{change:function(s){return e.handleSmallSelect(s,t)}},model:{value:t.ids,callback:function(s){e.$set(t,"ids",s)},expression:"item.ids"}},e._l(t.smallProjects,function(t){return s("el-checkbox",{key:t.sysGuid,attrs:{label:t.sysGuid}},[e._v(e._s(t.pname))])}),1)],1):e._e()]})],2)],1)]),s("div",{staticClass:"arrow-box flex-v-center"},[s("div",{staticClass:"iconfont bj-arrow-right"})]),s("div",{staticClass:"right-box"},[s("h4",[e._v("已选项目")]),s("div",{staticClass:"item-box"},[s("div",{staticClass:"table-box"},[s("el-table",{attrs:{data:e.checkedProjectList,height:"100%","header-cell-class-name":"custom-table-cell",stripe:""}},[s("el-table-column",{attrs:{label:"项目名称",prop:"pname",width:"120px",align:"center"}}),s("el-table-column",{attrs:{label:"小项名称",prop:"smallProjects",align:"center"}})],1)],1)])])])])],1)],1),s("footer",{staticClass:"btn-box"},[s("el-button",{staticClass:"btn-hollowing",on:{click:function(t){return e.$router.push({name:"SetMealList"})}}},[e._v("取消")]),s("el-button",{staticClass:"btn-info",attrs:{loading:e.submitLoading},on:{click:e.onSubmit}},[e._v("保存")])],1)],1)])},r=[],i=(s("6b54"),s("456d"),s("ac6a"),s("75fc")),a=s("b279"),n={name:"SetMealForm",props:{id:{type:String,required:!0}},data:function(){return{projectList:[],formFields:{packName:"",pySimpleCode:"",wbSimpleCode:"",enabled:"1",sortNum:"",projectIds:""},rules:{packName:[{required:!0,message:"请输入套餐名称",trigger:"blur",whitespace:!0}].concat(Object(i["a"])(Object(a["i"])())),sortNum:{required:!0,message:"请输入套餐顺序",trigger:"blur"},pySimpleCode:[{required:!0,message:"请输入拼音简码",trigger:"blur",whitespace:!0}].concat(Object(i["a"])(Object(a["i"])())),wbSimpleCode:{max:50,message:"最多输入50个字符",trigger:"blur"}},submitLoading:!1}},computed:{checkedProjectList:function(){return this.projectList.filter(function(e){return e.ids.length}).map(function(e){var t=e.smallProjects.filter(function(t){return~e.ids.indexOf(t.sysGuid)}).map(function(e){return e.pname}),s={pname:e.pname,smallProjects:t.join("、")};return s})}},beforeRouteEnter:function(e,t,s){"insert"===e.params.id&&(document.title="套餐新增"),s()},created:function(){this.initData(this.id)},methods:{initData:function(e){"insert"===e?this.getAllProject():this.getSetMealById(e)},getAllProject:function(){var e=this;this.$post("/sys/project/getThisOrgAllProject").then(function(t){var s=t.data;e.projectList=s.filter(function(e){return e.smallProjects.length}).map(function(e){return e.isAllSelect=!1,e.ids=[],e})}).catch(function(t){return e.$message.error(t)})},getSetMealById:function(e){var t=this;this.$post("/sys/projectPackage/getBySysGuid",{sysGuid:e}).then(function(e){var s=e.data,l=s.thisOrgAllProjects,r=s.packBasic,i=s.packChoice.map(function(e){return e.projectId});t.projectList=l.filter(function(e){return e.smallProjects.length}).map(function(e){return e.ids=[],e.smallProjects.forEach(function(t){~i.indexOf(t.sysGuid)&&e.ids.push(t.sysGuid)}),e}).map(function(e){return e.isAllSelect=e.ids.length===e.smallProjects.length,e}),Object.keys(t.formFields).forEach(function(e){t.formFields[e]=r[e]}),t.formFields.sysGuid=r.sysGuid,t.$nextTick(t.$refs.form.clearValidate)}).catch(function(e){return e})},handleAllSelect:function(e,t){t.ids=e?t.smallProjects.map(function(e){return e.sysGuid}):[]},handleSmallSelect:function(e,t){t.isAllSelect=e.length===t.smallProjects.length},onSubmit:function(){var e,t,s=this;"insert"===this.id?(t="新增",e="/sys/projectPackage/insert"):(t="修改",e="/sys/projectPackage/update"),this.$refs.form.validate(function(l){if(l){if(!s.handleIds())return s.$message.error("至少选择一个项目");s.submitLoading=!0,s.$post(e,s.formFields).then(function(e){s.submitLoading=!1,s.$message.success("".concat(t,"成功")),s.$router.back()}).catch(function(e){s.submitLoading=!1,s.$message.error(e)})}})},handleIds:function(){var e=[];return this.projectList.forEach(function(t){e=e.concat(t.ids)}),console.log(e),this.formFields.projectIds=e.toString(),e.length}}},o=n,c=(s("62ef"),s("2877")),u=Object(c["a"])(o,l,r,!1,null,"345b6a1c",null);t["default"]=u.exports},"95d5":function(e,t,s){var l=s("40c3"),r=s("5168")("iterator"),i=s("481b");e.exports=s("584a").isIterable=function(e){var t=Object(e);return void 0!==t[r]||"@@iterator"in t||i.hasOwnProperty(l(t))}},c8bb:function(e,t,s){e.exports=s("54a1")},d2d5:function(e,t,s){s("1654"),s("549b"),e.exports=s("584a").Array.from}}]);
//# sourceMappingURL=chunk-6dd6c1c4.19a69b9e.js.map